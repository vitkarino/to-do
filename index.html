<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="scss/main.css">
    <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>
    <title>ToDo</title>
</head>

<body>
    <div class="background-noise"></div>
    <h1>ToDo</h1>
    <div class="todo-container">
        <div class="input-container">
            <input type="text" placeholder="Enter a task">
            <iconify-icon id="add-task" icon="material-symbols:add" onclick="addTask()"
                style="color: white"></iconify-icon>
        </div>
        <ul class="taskList"></ul>
        <div class="separator"></div>
    </div>
    <button onclick="removeTasks()">Remove all tasks</button>

    <script type="text/javascript">
        var key = localStorage.length;

        window.onload = function getTasks() {
            const taskList = document.querySelector('.taskList');
            // for (let i = 0; i < localStorage.length; i++) {
            //     const taskKey = localStorage.key(i);
            //     const taskValue = localStorage.getItem(taskKey);
            //     const taskItem = createTaskItem(taskValue, taskKey);
            //     taskList.appendChild(taskItem);
            // }
        }

        // function loadTasks() {
        //     const taskList = document.querySelector('.taskList');
        //     for (let i = 0; i < localStorage.length; i++) {
        //         const taskKey = localStorage.key(i);
        //         const taskValue = localStorage.getItem(taskKey);
        //         const taskItem = createTaskItem(taskValue, taskKey);
        //         taskList.appendChild(taskItem);
        //     }
        // }

        // // function loadTasks() {
        // //     const taskList = document.querySelector('.taskList');
        // //     for (let i = 0; i < localStorage.length; i++) {
        // //         const taskKey = localStorage.key(i);
        // //         const taskValue = localStorage.getItem(taskKey);
        // //         const taskItem = createTaskItem(taskValue, taskKey);
        // //         taskList.appendChild(taskItem);
        // //     }
        // // }

        function addTask() {
            const taskList = document.querySelector('.taskList');
            const newTask = createTaskItem(); 
            taskList.appendChild(newTask);
        }

        function createTaskItem() {
            const taskItem = document.createElement('li');
            var inputValue = document.querySelector('input').value;

            taskItem.className = 'task-item';

            const taskText = document.createElement('span');
            taskText.className = 'task-text';
            taskText.textContent = inputValue;
            taskItem.appendChild(taskText);

            const taskControls = document.createElement('div');
            taskControls.className = 'task-controls';

            taskControls.appendChild(createCheckbox());
            taskControls.appendChild(createDeleteIcon(taskItem));

            taskItem.appendChild(taskControls);

            localStorage.setItem(key, inputValue);
            key++;

            return taskItem;
        }

        function createDeleteIcon(taskItem) {
            const deleteIcon = document.createElement('iconify-icon');
            deleteIcon.setAttribute('icon', 'material-symbols:delete');
            deleteIcon.className = 'delete-icon';

            deleteIcon.onclick = function () {
                removeTask(taskItem);
            };

            return deleteIcon;
        }

        function createCheckbox() {
            const checkboxContainer = document.createElement('div');
            checkboxContainer.className = 'checkbox-container';

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkboxContainer.appendChild(checkbox);

            const checkmarkIcon = document.createElement('iconify-icon');
            checkmarkIcon.setAttribute('icon', 'material-symbols:done');
            checkmarkIcon.className = 'checkmark';
            checkmarkIcon.style.color = 'white';
            checkboxContainer.appendChild(checkmarkIcon);

            return checkboxContainer;
        }

        function createSeparator() {

        }

        function removeTask(taskItem) {
            const taskKey = taskItem.getAttribute('data-key');
            localStorage.removeItem(taskKey);
            taskItem.remove();
        }

        function removeTasks() {
            document.querySelector('.taskList').innerHTML = "";
            localStorage.clear();
            key = 0;
        }
    </script>
</body>

</html>