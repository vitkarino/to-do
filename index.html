<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="scss/main.css">
    <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>
    <title>ToDo</title>
</head>

<body>
    <div class="background-noise"></div>
    <h1>ToDo</h1>
    <div class="todo-container">
        <div class="input-container">
            <input type="text" placeholder="Enter a task">
            <iconify-icon id="add-task" icon="material-symbols:add" onclick="addTask()"
                style="color: white"></iconify-icon>
        </div>
        <ul class="taskList"></ul>
        <div class="separator"></div>
    </div>
    <button onclick="removeTasks()">Remove all tasks</button>

    <script type="text/javascript">
        var key = localStorage.length;

        function addTask() {
            const taskList = document.querySelector('.taskList');
            const newTask = createTaskItem();
            taskList.appendChild(newTask);
        }

        function createTaskItem() {
            const taskItem = document.createElement('li');
            var inputValue = document.querySelector('input').value;

            taskItem.className = 'task-item';

            const taskText = document.createElement('span');
            taskText.className = 'task-text';
            taskText.textContent = inputValue;
            taskItem.appendChild(createCheckbox(taskItem, taskText));
            taskItem.appendChild(taskText);

            const taskControls = document.createElement('div');
            taskControls.className = 'task-controls';

            taskControls.appendChild(createDeleteIcon(taskItem));

            taskItem.appendChild(taskControls);

            localStorage.setItem(key, inputValue);
            key++;

            return taskItem;
        }

        function createDeleteIcon(taskItem) {
            const deleteIcon = document.createElement('iconify-icon');
            deleteIcon.setAttribute('icon', 'material-symbols:delete');
            deleteIcon.className = 'delete-icon';

            deleteIcon.onclick = function () {
                removeTask(taskItem);
            };

            return deleteIcon;
        }

        function createCheckbox(taskItem, taskText) {
            const checkmarkIcon = document.createElement('iconify-icon');
            checkmarkIcon.setAttribute('icon', 'material-symbols:done');
            checkmarkIcon.className = 'checkmark';
            checkmarkIcon.style.color = 'transparent';

            checkmarkIcon.onclick = function () {
                markCompleted(taskItem, taskText, checkmarkIcon);
            };

            return checkmarkIcon;
        }

        function markCompleted(taskItem, taskText, checkmarkIcon) {
            if (checkmarkIcon.style.color === 'white') {
                checkmarkIcon.style.color = 'transparent'; 
                taskText.style.textDecoration = 'none'
            } else {
                checkmarkIcon.style.color = 'white'; 
                taskText.style.textDecoration = 'line-through'
            }
        }

        function removeTask(task) {
            localStorage.removeItem();
            taskItem.remove();
        }

        function removeTasks() {
            document.querySelector('.taskList').innerHTML = "";
            localStorage.clear();
            key = 0;
        }
    </script>
</body>

</html>